---
title: "govulncheckã§Goãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è„†å¼±æ€§ã‚’æ¤œå‡ºï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³æ¯ã®å‡ºåŠ›ã®é•ã„ï¼‰"
emoji: "ğŸ‘¾"
type: "tech"
topics: ["go"]
published: true
---


ã“ã®è¨˜äº‹ã¯ ã‚«ã‚ªãƒŠãƒ“ Advent Calendar 2024(ã‚·ãƒ¼ã‚ºãƒ³1) 9æ—¥ç›®ã§ã™ã€‚

https://qiita.com/advent-calendar/2024/kaonavi

---

# govulncheckã¨ã¯

Goã®è„†å¼±æ€§ã‚’æ¤œå‡ºã—ã¦ãã‚Œã‚‹ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹è„†å¼±æ€§ã ã‘ã«ãƒ¬ãƒãƒ¼ãƒˆã—ã¦ãã‚Œã¦
ãƒ¬ãƒãƒ¼ãƒˆã«ã¯è„†å¼±æ€§ãŒä¿®æ­£ã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€è„†å¼±æ€§ã®ã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹ã‚³ãƒ¼ãƒ‰è¡Œã‚‚è¡¨ç¤ºã—ã¦ãã‚Œã¾ã™ã€‚
ä¾¿åˆ©ğŸ˜€

https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck

ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚‚ã‚ã‚Šã¾ã™

https://go.dev/doc/tutorial/govulncheck

## govulncheckã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¦‹ã‚‹ã¨ `-format`, `-show`ãªã©å‡ºåŠ›å†…å®¹ã‚’å¤‰æ›´ã§ããã†ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒå­˜åœ¨ã—ã¾ã™ã€‚

â€»`-json` ã¯å¤ã„ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãªã®ã§`-format=json`ã‚’ä½¿ã„ã¾ã—ã‚‡ã†
â€»`-show=verbose`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ãŸå ´åˆ`-format=text`ä»¥å¤–ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã¯ã§ããªã„ã‚ˆã†ã§ã™

```sh
$ govulncheck -h
Govulncheck reports known vulnerabilities in dependencies.

Usage:

        govulncheck [flags] [patterns]
        govulncheck -mode=binary [flags] [binary]

  -C dir
        change to dir before running govulncheck
  -db url
        vulnerability database url (default "https://vuln.go.dev")
  -format value
        specify format output
        The supported values are 'text', 'json', 'sarif', and 'openvex' (default 'text')
  -json
        output JSON (Go compatible legacy flag, see format flag)
  -mode value
        supports 'source', 'binary', and 'extract' (default 'source')
  -scan value
        set the scanning level desired, one of 'module', 'package', or 'symbol' (default 'symbol')
  -show list
        enable display of additional information specified by the comma separated list
        The supported values are 'traces','color', 'version', and 'verbose'
  -tags list
        comma-separated list of build tags
  -test
        analyze test files (only valid for source mode, default false)
  -version
        print the version information

For details, see https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck.
```

# Goã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§å‡ºåŠ›çµæœã‚’æ‰±ã„ãŸã„

å‡ºåŠ›çµæœãŒé•·ããªã‚‹ã®ã§ã€çµæœã‚’Goã§æ‰±ã†ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®è¨˜äº‹ã«æ›¸ã„ã¦ãŠã‚Šã¾ã™ğŸ˜€

https://zenn.dev/masakurapa/articles/d7b8f00762f6f8

---

**â€»ä»¥é™ã¯ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ + å„ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å‡ºåŠ›çµæœã«ãªã‚Šã¾ã™**

# æ¤œè¨¼ã‚³ãƒ¼ãƒ‰

```sh
sample
â”œâ”€â”€ go.work
â”œâ”€â”€ mod1
â”‚Â Â  â”œâ”€â”€ go.mod
â”‚Â Â  â””â”€â”€ mod1.go
â”œâ”€â”€ mod2
â”‚Â Â  â”œâ”€â”€ go.mod
â”‚Â Â  â””â”€â”€ mod2.go
â””â”€â”€ mod3
    â”œâ”€â”€ go.mod
    â””â”€â”€ mod3.go
```

## è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰

- `golang-jwt/jwt`ã®`v4.5.0`ã¯è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œã¦ãŠã‚Š[v4.5.1](https://github.com/golang-jwt/jwt/releases/tag/v4.5.1)ã§ä¿®æ­£ã•ã‚Œã¦ã„ã¾ã™
- `mod1.go`ã¯è„†å¼±æ€§ãŒæ¤œçŸ¥ã•ã‚Œã‚‹ã‚ˆã†ã«ParseWithClaimsã‚’å‘¼ã³å‡ºã—ã¾ã™

```go:go.mod
module sample/mod1

go 1.23.3

require github.com/golang-jwt/jwt/v4 v4.5.0
```

```go:mod1.go
package mod1

func Run() {
	type claims struct {
		jwt.Claims
	}
	keyFunc := func(token *jwt.Token) (interface{}, error) { return nil, nil }
	_, _ = jwt.ParseWithClaims("sample token", &claims{}, keyFunc)
}

func NoVuln() {}
```

## è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œã‚‹å‡¦ç†ã‚’å‘¼ã³å‡ºã—ã¦ã„ãªã„ã€ãŒä¾å­˜ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«è„†å¼±æ€§ãŒã‚ã‚‹ã‚³ãƒ¼ãƒ‰

- `bar.go` ãŒå‘¼ã³å‡ºã—ã¦ã„ã‚‹`sample/foo`ã®é–¢æ•°`Foo2()`ã§ã¯è„†å¼±æ€§ã®å«ã¾ã‚Œã‚‹å‡¦ç†ã‚’å‘¼ã³å‡ºã—ã¦ã„ã¾ã›ã‚“
- ã—ã‹ã—å‘¼ã³å‡ºã—ã¦ã„ãªã„é–¢æ•°`Foo()`ã§ã¯è„†å¼±æ€§ã®å«ã¾ã‚Œã‚‹å‡¦ç†ã‚’å‘¼ã³å‡ºã—ã¦ã„ã¾ã™

```go:go.mod
module sample/mod2

go 1.23.3
```

```go:mod2.go
package mod2

import (
	"sample/mod1"
)

func Run() {
	mod1.NoVuln()
}
```

## è„†å¼±æ€§ãŒæ¤œå‡ºã•ã‚Œãªã„ã‚³ãƒ¼ãƒ‰

- ä½•ã‚‚æ›¸ã„ã¦ã„ãªã„ã®ã§ä½•ã‚‚æ¤œçŸ¥ã•ã‚Œã¾ã›ã‚“

```go:go.mod
module sample/mod3

go 1.23.3
```

```go:mod3.go
package mod3

func Run() {}
```

# è„†å¼±æ€§ãƒã‚§ãƒƒã‚¯ã‚’è©¦ã™

## ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã—

### package mod1

è„†å¼±æ€§ã®è©³ç´°ãŒæ›¸ã‹ã‚ŒãŸURLã€è„†å¼±æ€§ãŒè¦‹ã¤ã‹ã£ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€è„†å¼±æ€§ãŒä¿®æ­£ã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¾ã™
å‡ºåŠ›ã‚‚æ•´å½¢ã•ã‚Œã¦ãŠã‚Šè¦‹ã‚„ã™ã„ã§ã™ğŸ˜€

å‡ºåŠ›ã‚’è¦‹ã‚‹ãƒã‚¤ãƒ³ãƒˆã¨ã—ã¦ã¯

- `More info:` -> è„†å¼±æ€§ã®è©³ç´°ãŒæ›¸ã‹ã‚ŒãŸURL
- `Module:` -> è„†å¼±æ€§ãŒå­˜åœ¨ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å
- `Found in:` -> è„†å¼±æ€§ãŒæ¤œçŸ¥ã•ã‚ŒãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³
- `Fixed in:` -> è„†å¼±æ€§ãŒä¿®æ­£ã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³
- `Example traces found:` -> è‡ªèº«ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã§ã®è„†å¼±æ€§ãŒã‚ã‚‹ã‚³ãƒ¼ãƒ‰ã®å‘¼ã³å‡ºã—ç®‡æ‰€

```sh
$ govulncheck ./...
=== Symbol Results ===

Vulnerability #1: GO-2024-3250
    Improper error handling in ParseWithClaims and bad documentation may cause
    dangerous situations in github.com/golang-jwt/jwt
  More info: https://pkg.go.dev/vuln/GO-2024-3250
  Module: github.com/golang-jwt/jwt/v4
    Found in: github.com/golang-jwt/jwt/v4@v4.5.0
    Fixed in: github.com/golang-jwt/jwt/v4@v4.5.1
    Example traces found:
      #1: mod1.go:12:28: mod1.Run calls jwt.ParseWithClaims

Your code is affected by 1 vulnerability from 1 module.
This scan found no other vulnerabilities in packages you import or modules you
require.
Use '-show verbose' for more details.
```

### package mod2

`No vulnerabilities found.` ã¨è¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ãŒ
importã—ã¦ã„ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«è„†å¼±æ€§ãŒã‚ã‚Šã¾ã™ã€ã®ã‚ˆã†ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™

```sh
$ govulncheck ./...
=== Symbol Results ===

No vulnerabilities found.

Your code is affected by 0 vulnerabilities.
This scan also found 1 vulnerability in packages you import and 0
vulnerabilities in modules you require, but your code doesn't appear to call
these vulnerabilities.
Use '-show verbose' for more details.
```

### package mod3

```sh
$ govulncheck ./...
No vulnerabilities found.
```

## `-show=verbose`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®š

### package mod1

`Symbol Results` ã®å‡ºåŠ›å†…å®¹ã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ãŒã€
`Package Results`ã¨`Module Results` ã¨ã„ã†é …ç›®ãŒå¢—ãˆã¾ã—ãŸ

```sh
$ govulncheck -show=verbose ./...
Scanning your code and 112 packages across 2 dependent modules for known vulnerabilities...

Fetching vulnerabilities from the database...

Checking the code against the vulnerabilities...

=== Symbol Results ===

Vulnerability #1: GO-2024-3250
    Improper error handling in ParseWithClaims and bad documentation may cause
    dangerous situations in github.com/golang-jwt/jwt
  More info: https://pkg.go.dev/vuln/GO-2024-3250
  Module: github.com/golang-jwt/jwt/v4
    Found in: github.com/golang-jwt/jwt/v4@v4.5.0
    Fixed in: github.com/golang-jwt/jwt/v4@v4.5.1
    Example traces found:
      #1: mod1.go:12:28: mod1.Run calls jwt.ParseWithClaims

=== Package Results ===

No other vulnerabilities found.

=== Module Results ===

No other vulnerabilities found.

Your code is affected by 1 vulnerability from 1 module.
This scan found no other vulnerabilities in packages you import or modules you
require.
```

### package mod2

`Package Results` ã«ä¾å­˜ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆsample/mod1ï¼‰ã«å­˜åœ¨ã™ã‚‹è„†å¼±æ€§ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸ
ç›´æ¥ä½¿ã£ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„ã®ã§å½±éŸ¿ãŒã‚ã‚‹è¨³ã§ã¯ãªã„ã§ã™ãŒã€ä¾å­˜ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è„†å¼±æ€§ã‚‚æ¤œå‡ºã—ã¦ãã‚Œã¾ã™ã€‚

```sh
$ govulncheck -show=verbose ./...
Scanning your code and 113 packages across 3 dependent modules for known vulnerabilities...

Fetching vulnerabilities from the database...

Checking the code against the vulnerabilities...

=== Symbol Results ===

No vulnerabilities found.

=== Package Results ===

Vulnerability #1: GO-2024-3250
    Improper error handling in ParseWithClaims and bad documentation may cause
    dangerous situations in github.com/golang-jwt/jwt
  More info: https://pkg.go.dev/vuln/GO-2024-3250
  Module: github.com/golang-jwt/jwt/v4
    Found in: github.com/golang-jwt/jwt/v4@v4.5.0
    Fixed in: github.com/golang-jwt/jwt/v4@v4.5.1

=== Module Results ===

No other vulnerabilities found.

Your code is affected by 0 vulnerabilities.
This scan also found 1 vulnerability in packages you import and 0
vulnerabilities in modules you require, but your code doesn't appear to call
these vulnerabilities.
```

### package mod3

```sh
$ govulncheck -show=verbose ./...
Scanning your code and 0 packages across 1 dependent module for known vulnerabilities...

Fetching vulnerabilities from the database...

Checking the code against the vulnerabilities...

No vulnerabilities found.
```

## `-show=traces`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®š

â€»mod2, mod3ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ç„¡ã—ã¨çµæœãŒå¤‰ã‚ã‚‰ãªã‹ã£ãŸã®ã§å‰²æ„›

### package mod1

```sh
$ govulncheck -show=traces ./...
=== Symbol Results ===

Vulnerability #1: GO-2024-3250
    Improper error handling in ParseWithClaims and bad documentation may cause
    dangerous situations in github.com/golang-jwt/jwt
  More info: https://pkg.go.dev/vuln/GO-2024-3250
  Module: github.com/golang-jwt/jwt/v4
    Found in: github.com/golang-jwt/jwt/v4@v4.5.0
    Fixed in: github.com/golang-jwt/jwt/v4@v4.5.1
    Example traces found:
      #1: for function github.com/golang-jwt/jwt/v4.ParseWithClaims
        mod1.go:12:28: sample/mod1.Run
        token.go:113:6: github.com/golang-jwt/jwt/v4.ParseWithClaims

Your code is affected by 1 vulnerability from 1 module.
This scan found no other vulnerabilities in packages you import or modules you
require.
Use '-show verbose' for more details.
```

å·®åˆ†ã¨ã—ã¦ã¯ä»¥ä¸‹ã®å†…å®¹ãŒå¢—ãˆã¾ã—ãŸ

```diff
    Example traces found:
      #1: for function github.com/golang-jwt/jwt/v4.ParseWithClaims
        mod1.go:12:28: sample/mod1.Run
+       token.go:113:6: github.com/golang-jwt/jwt/v4.ParseWithClaims
```

## `-show=color`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®š

ã‚ªãƒ—ã‚·ãƒ§ãƒ³æŒ‡å®šç„¡ã—ã®å®Ÿè¡ŒçµæœãŒã€ã¡ã‚‡ã£ã¨ã‚«ãƒ©ãƒ•ãƒ«ã«ãªã‚Šã¾ã™:rainbow:

## `-show=version`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®š

å®Ÿè¡Œç’°å¢ƒã®Goã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€govulncheckã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã€è„†å¼±æ€§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
CIã§ã‚‚ã©ã®ã‚ˆã†ãªç’°å¢ƒã§å®Ÿè¡Œã•ã‚ŒãŸã‹åˆ†ã‹ã‚‹ãŸã‚å‡ºåŠ›ã—ã¦ãŠãã¨è‰¯ã•ãã†ã«æ€ã„ã¾ã™ã€‚

```sh
$ govulncheck -show=version ./...
Go: go1.23.3
Scanner: govulncheck@v1.1.3
DB: https://vuln.go.dev
DB updated: 2024-11-27 19:16:39 +0000 UTC

=== Symbol Results ===

Vulnerability #1: GO-2024-3250
    Improper error handling in ParseWithClaims and bad documentation may cause
    dangerous situations in github.com/golang-jwt/jwt
  More info: https://pkg.go.dev/vuln/GO-2024-3250
  Module: github.com/golang-jwt/jwt/v4
    Found in: github.com/golang-jwt/jwt/v4@v4.5.0
    Fixed in: github.com/golang-jwt/jwt/v4@v4.5.1
    Example traces found:
      #1: mod1.go:12:28: mod1.Run calls jwt.ParseWithClaims

Your code is affected by 1 vulnerability from 1 module.
This scan found no other vulnerabilities in packages you import or modules you
require.
Use '-show verbose' for more details.
```

## `-format=sarif`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®š

Static Analysis Results Interchange Formatï¼ˆSARIFï¼‰ã¨ã¯é™çš„è§£æãƒ„ãƒ¼ãƒ«ã®å‡ºåŠ›ã®æ¨™æº–å½¢å¼ã§ã™

https://sarifweb.azurewebsites.net/

### package mod1

`runs.tool.rules`ã«æ¤œå‡ºã•ã‚ŒãŸè„†å¼±æ€§ã®è©³ç´°æƒ…å ±ãŒå‡ºåŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚
ã¾ãŸ`results`ã«æ¤œå‡ºã•ã‚ŒãŸè„†å¼±æ€§ã¨`"level": "error",` ãŒå‡ºåŠ›ã•ã‚Œã¦ãŠã‚Šã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§å¯¾å¿œãŒå¿…è¦ãªè„†å¼±æ€§ã§ã‚ã‚‹ã¨åˆ¤æ–­ã§ãã¾ã™ã€‚
`codeFlows`ã§ã¯`-show=traces`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ãŸå ´åˆã®å‡ºåŠ›çµæœãŒå…¥ã£ã¦ã„ã‚‹ã‚ˆã†ã§ã™ã€‚

```sh
$ govulncheck -format=sarif ./...
{
  "version": "2.1.0",
  "$schema": "https://json.schemastore.org/sarif-2.1.0.json",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "govulncheck",
          "semanticVersion": "v1.1.3",
          "informationUri": "https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck",
          "properties": {
            "protocol_version": "v1.0.0",
            "scanner_name": "govulncheck",
            "scanner_version": "v1.1.3",
            "db": "https://vuln.go.dev",
            "db_last_modified": "2024-11-27T19:16:39Z",
            "go_version": "go1.23.3",
            "scan_level": "symbol",
            "scan_mode": "source"
          },
          "rules": [
            {
              "id": "GO-2024-3250",
              "shortDescription": {
                "text": "[GO-2024-3250] Improper error handling in ParseWithClaims and bad documentation may cause dangerous situations in github.com/golang-jwt/jwt"
              },
              "fullDescription": {
                "text": "Improper error handling in ParseWithClaims and bad documentation may cause dangerous situations in github.com/golang-jwt/jwt"
              },
              "help": {
                "text": "Improper error handling in ParseWithClaims and bad documentation may cause dangerous situations in github.com/golang-jwt/jwt"
              },
              "helpUri": "https://pkg.go.dev/vuln/GO-2024-3250",
              "properties": {
                "tags": [
                  "CVE-2024-51744",
                  "GHSA-29wx-vh33-7x7r"
                ]
              }
            }
          ]
        }
      },
      "results": [
        {
          "ruleId": "GO-2024-3250",
          "level": "error",
          "message": {
            "text": "Your code calls vulnerable functions in 1 package (github.com/golang-jwt/jwt/v4)."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "go.mod",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 1
                }
              },
              "message": {
                "text": "Findings for vulnerability GO-2024-3250"
              }
            }
          ],
          "codeFlows": [
            {
              "threadFlows": [
                {
                  "locations": [
                    {
                      "module": "sample/mod1@",
                      "location": {
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "mod1.go",
                            "uriBaseId": "%SRCROOT%"
                          },
                          "region": {
                            "startLine": 12,
                            "startColumn": 28
                          }
                        },
                        "message": {
                          "text": "sample/mod1.Run"
                        }
                      }
                    },
                    {
                      "module": "github.com/golang-jwt/jwt/v4@v4.5.0",
                      "location": {
                        "physicalLocation": {
                          "artifactLocation": {
                            "uri": "github.com/golang-jwt/jwt/v4@v4.5.0/token.go",
                            "uriBaseId": "%GOMODCACHE%"
                          },
                          "region": {
                            "startLine": 113,
                            "startColumn": 6
                          }
                        },
                        "message": {
                          "text": "github.com/golang-jwt/jwt/v4.ParseWithClaims"
                        }
                      }
                    }
                  ]
                }
              ],
              "message": {
                "text": "A summarized code flow for vulnerable function github.com/golang-jwt/jwt/v4.ParseWithClaims"
              }
            }
          ],
          "stacks": [
            {
              "message": {
                "text": "A call stack for vulnerable function github.com/golang-jwt/jwt/v4.ParseWithClaims"
              },
              "frames": [
                {
                  "module": "sample/mod1@",
                  "location": {
                    "physicalLocation": {
                      "artifactLocation": {
                        "uri": "mod1.go",
                        "uriBaseId": "%SRCROOT%"
                      },
                      "region": {
                        "startLine": 12,
                        "startColumn": 28
                      }
                    },
                    "message": {
                      "text": "sample/mod1.Run"
                    }
                  }
                },
                {
                  "module": "github.com/golang-jwt/jwt/v4@v4.5.0",
                  "location": {
                    "physicalLocation": {
                      "artifactLocation": {
                        "uri": "github.com/golang-jwt/jwt/v4@v4.5.0/token.go",
                        "uriBaseId": "%GOMODCACHE%"
                      },
                      "region": {
                        "startLine": 113,
                        "startColumn": 6
                      }
                    },
                    "message": {
                      "text": "github.com/golang-jwt/jwt/v4.ParseWithClaims"
                    }
                  }
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
```

### package mod2

`results`ã¯è¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ãŒã€ `"level": "warning",` ã¨ãªã£ã¦ã„ã¾ã™ã€‚
ã“ã“ã§è‡ªåˆ†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ç›´æ¥å½±éŸ¿ãŒã‚ã‚‹ã‚‚ã®ã‹ã©ã†ã‹åˆ¤æ–­ã§ããã†ã§ã™ã€‚

```sh
$ govulncheck -format=sarif ./...
{
  "version": "2.1.0",
  "$schema": "https://json.schemastore.org/sarif-2.1.0.json",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "govulncheck",
          "semanticVersion": "v1.1.3",
          "informationUri": "https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck",
          "properties": {
            "protocol_version": "v1.0.0",
            "scanner_name": "govulncheck",
            "scanner_version": "v1.1.3",
            "db": "https://vuln.go.dev",
            "db_last_modified": "2024-11-27T19:16:39Z",
            "go_version": "go1.23.3",
            "scan_level": "symbol",
            "scan_mode": "source"
          },
          "rules": [
            {
              "id": "GO-2024-3250",
              "shortDescription": {
                "text": "[GO-2024-3250] Improper error handling in ParseWithClaims and bad documentation may cause dangerous situations in github.com/golang-jwt/jwt"
              },
              "fullDescription": {
                "text": "Improper error handling in ParseWithClaims and bad documentation may cause dangerous situations in github.com/golang-jwt/jwt"
              },
              "help": {
                "text": "Improper error handling in ParseWithClaims and bad documentation may cause dangerous situations in github.com/golang-jwt/jwt"
              },
              "helpUri": "https://pkg.go.dev/vuln/GO-2024-3250",
              "properties": {
                "tags": [
                  "CVE-2024-51744",
                  "GHSA-29wx-vh33-7x7r"
                ]
              }
            }
          ]
        }
      },
      "results": [
        {
          "ruleId": "GO-2024-3250",
          "level": "warning",
          "message": {
            "text": "Your code imports 1 vulnerable package (github.com/golang-jwt/jwt/v4), but doesnâ€™t appear to call any of the vulnerable symbols."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "go.mod",
                  "uriBaseId": "%SRCROOT%"
                },
                "region": {
                  "startLine": 1
                }
              },
              "message": {
                "text": "Findings for vulnerability GO-2024-3250"
              }
            }
          ]
        }
      ]
    }
  ]
}
```

### package mod3

è„†å¼±æ€§ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯`runs.tool.rules`, `results`ãŒå‡ºåŠ›ã•ã‚Œãªããªã‚Šã¾ã—ãŸ

```sh
$ govulncheck -format=sarif ./...
{
  "version": "2.1.0",
  "$schema": "https://json.schemastore.org/sarif-2.1.0.json",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "govulncheck",
          "semanticVersion": "v1.1.3",
          "informationUri": "https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck",
          "properties": {
            "protocol_version": "v1.0.0",
            "scanner_name": "govulncheck",
            "scanner_version": "v1.1.3",
            "db": "https://vuln.go.dev",
            "db_last_modified": "2024-11-27T19:16:39Z",
            "go_version": "go1.23.3",
            "scan_level": "symbol",
            "scan_mode": "source"
          }
        }
      }
    }
  ]
}
```

## `-format=openvex`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®š

https://github.com/openvex/spec

> OpenVEX is an implementation of the Vulnerability Exploitability Exchange (VEX for short) that is designed to be minimal, compliant, interoperable, and embeddable. The specification is available in the OPENVEX-SPEC.md file of this repository.

Googleè¨³

> OpenVEX ã¯ã€æœ€å°é™ã€æº–æ‹ ã€ç›¸äº’é‹ç”¨æ€§ã€åŸ‹ã‚è¾¼ã¿æ€§ã‚’å®Ÿç¾ã™ã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚ŒãŸã€Vulnerability Exploitability Exchange (VEX)ã®å®Ÿè£…ã§ã™ã€‚

### package mod1

æ¤œå‡ºã•ã‚ŒãŸè„†å¼±æ€§ã®æƒ…å ±ã¯å‡ºåŠ›ã•ã‚Œã¾ã™ãŒã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã®æ¤œå‡ºç®‡æ‰€ã«é–¢ã™ã‚‹æƒ…å ±ã¯ãªããªã‚Šã¾ã—ãŸã€‚
å†…å®¹ã¨ã—ã¦ã¯ã‹ãªã‚Šã‚·ãƒ³ãƒ—ãƒ«ã«ãªã‚Šã¾ã—ãŸã€‚
`"status": "affected"` ã§ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å½±éŸ¿ã®ã‚ã‚‹è„†å¼±æ€§ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

```sh
$ govulncheck -format=openvex ./...
{
  "@context": "https://openvex.dev/ns/v0.2.0",
  "@id": "govulncheck/vex:4c2d5514af28c4a0af7e6e0e41e7e9edf08bb78109760380ac776176eca4d73b",
  "author": "Unknown Author",
  "timestamp": "2024-11-28T15:29:02.404127Z",
  "version": 1,
  "tooling": "https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck",
  "statements": [
    {
      "vulnerability": {
        "@id": "https://pkg.go.dev/vuln/GO-2024-3250",
        "name": "GO-2024-3250",
        "description": "Improper error handling in ParseWithClaims and bad documentation may cause dangerous situations in github.com/golang-jwt/jwt",
        "aliases": [
          "CVE-2024-51744",
          "GHSA-29wx-vh33-7x7r"
        ]
      },
      "products": [
        {
          "@id": "Unknown Product"
        }
      ],
      "status": "affected"
    }
  ]
}
```

### package mod2

ã“ã¡ã‚‰ã‚‚åŒæ§˜ã«ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ãŒè‹¥å¹²æƒ…å ±ãŒå¢—ãˆã¦ã„ã‚‹ã‚ˆã†ã§ã™
`"status": "not_affected",` ã§ç›´æ¥å½±éŸ¿ã®ã‚ã‚‹è„†å¼±æ€§ã§ãªã„ã“ã¨ã¯åˆ†ã‹ã‚Šã¾ã™ã€‚
`justification`ã¨`impact_statement`ã«ã¯ãªãœå½±éŸ¿ãŒãªã„ã‹ã€ã¨ã„ã†ç†ç”±ãŒå‡ºåŠ›ã•ã‚Œã¦ã„ã¾ã™ã€‚

```sh
$ govulncheck -format=openvex ./...
{
  "@context": "https://openvex.dev/ns/v0.2.0",
  "@id": "govulncheck/vex:c6c21792e5ef0187e993b6866abc8b9358d6de429c931c92aa95071e198f2b59",
  "author": "Unknown Author",
  "timestamp": "2024-11-28T15:29:02.533188Z",
  "version": 1,
  "tooling": "https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck",
  "statements": [
    {
      "vulnerability": {
        "@id": "https://pkg.go.dev/vuln/GO-2024-3250",
        "name": "GO-2024-3250",
        "description": "Improper error handling in ParseWithClaims and bad documentation may cause dangerous situations in github.com/golang-jwt/jwt",
        "aliases": [
          "CVE-2024-51744",
          "GHSA-29wx-vh33-7x7r"
        ]
      },
      "products": [
        {
          "@id": "Unknown Product"
        }
      ],
      "status": "not_affected",
      "justification": "vulnerable_code_not_in_execute_path",
      "impact_statement": "Govulncheck determined that the vulnerable code isn't called"
    }
  ]
}
```

### package mod3

`statements` è‡ªä½“ãŒå‡ºåŠ›ã•ã‚Œã¾ã›ã‚“ã€‚

```sh
$ govulncheck -format=openvex ./...
{
  "@context": "https://openvex.dev/ns/v0.2.0",
  "@id": "govulncheck/vex:dbe7160a7e784903e7018529dca9791796885b4a0bad84a321cecbf1dc0473a5",
  "author": "Unknown Author",
  "timestamp": "2024-11-28T15:29:02.183641Z",
  "version": 1,
  "tooling": "https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck"
}
```

## `-format=json`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®š

â€»å‡ºåŠ›ãŒéå¸¸ã«é•·ã„ã®ã§å†…å®¹ã¯ã‚¬ãƒƒãƒ„ãƒªå‰²æ„›ã—ã¾ã™

å¤§ããåˆ†ã‘ã‚‹ã¨ `config`, `progress` `osv`, `finding` ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§JSONãŒå‡ºåŠ›ã•ã‚Œã¾ã™ã€‚
ç›®ã§è¦‹ã‚‹ã«ã¯ã‹ãªã‚Šãã¤ã„é‡ãŒå‡ºåŠ›ã•ã‚Œã¾ã—ãŸã€‚

`config`: `-show=version`ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å‡ºåŠ›ã•ã‚Œã¦ã„ãŸå†…å®¹ã¨åŒã˜
`progress`: INFOãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¿ãŸã„ãªã‚‚ã®
`osv`: è„†å¼±æ€§ã®è©³ç´°æƒ…å ±ï¼ˆä¿®æ­£ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãªã©ã‚‚ã“ã“ã«å«ã¾ã‚Œã‚‹ï¼‰
`finding` æ¤œå‡ºã•ã‚ŒãŸè„†å¼±æ€§ã®æƒ…å ±ï¼ˆä¾å­˜ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã¿ã§æ¤œå‡ºã•ã‚Œã¦ã„ã‚‹è„†å¼±æ€§ã®å ´åˆã¯`trace`ã¯å‡ºåŠ›ã•ã‚Œãªã„ã§ã™ï¼‰

```sh
$ govulncheck -format=json ./...
{
  "config": {
    "protocol_version": "v1.0.0",
    "scanner_name": "govulncheck",
    "scanner_version": "v1.1.3",
    "db": "https://vuln.go.dev",
    "db_last_modified": "2024-11-27T19:16:39Z",
    "go_version": "go1.23.3",
    "scan_level": "symbol",
    "scan_mode": "source"
  }
}
{
  "progress": {
    "message": "Scanning your code and 112 packages across 2 dependent modules for known vulnerabilities..."
  }
}
{
  "progress": {
    "message": "Fetching vulnerabilities from the database..."
  }
}
{
  "osv": {
    "schema_version": "1.3.1",
    "id": "GO-2024-3250",
    "modified": "2024-11-12T14:50:10Z",
    "published": "2024-11-12T13:55:08Z",
    "aliases": [
      "CVE-2024-51744",
      "GHSA-29wx-vh33-7x7r"
    ],
    "summary": "Improper error handling in ParseWithClaims and bad documentation may cause dangerous situations in github.com/golang-jwt/jwt",
    "details": "Improper error handling in ParseWithClaims and bad documentation may cause dangerous situations in github.com/golang-jwt/jwt",
    "affected": [
      {
        "package": {
          "name": "github.com/golang-jwt/jwt/v4",
          "ecosystem": "Go"
        },
        "ranges": [
          {
            "type": "SEMVER",
            "events": [
              {
                "introduced": "0"
              },
              {
                "fixed": "4.5.1"
              }
            ]
          }
        ],
        "ecosystem_specific": {
          "imports": [
            {
              "path": "github.com/golang-jwt/jwt/v4",
              "symbols": [
                "Parse",
                "ParseWithClaims",
                "Parser.Parse",
                "Parser.ParseWithClaims"
              ]
            }
          ]
        }
      }
    ],
    "references": [
      {
        "type": "ADVISORY",
        "url": "https://github.com/golang-jwt/jwt/security/advisories/GHSA-29wx-vh33-7x7r"
      },
      {
        "type": "FIX",
        "url": "https://github.com/golang-jwt/jwt/commit/7b1c1c00a171c6c79bbdb40e4ce7d197060c1c2c"
      }
    ],
    "database_specific": {
      "url": "https://pkg.go.dev/vuln/GO-2024-3250",
      "review_status": "REVIEWED"
    }
  }
}
ã€œã€œã€œ osvã®JSONãŒãƒ‰ãƒãƒ¼ãƒƒã¨å‡ºåŠ›ã•ã‚Œã‚‹ ã€œã€œã€œ
{
  "progress": {
    "message": "Checking the code against the vulnerabilities..."
  }
}
ã€œã€œã€œ findingã®JSONãŒãƒ‰ãƒãƒ¼ãƒƒã¨å‡ºåŠ›ã•ã‚Œã‚‹ ã€œã€œã€œ
{
  "finding": {
    "osv": "GO-2024-3250",
    "fixed_version": "v4.5.1",
    "trace": [
      {
        "module": "github.com/golang-jwt/jwt/v4",
        "version": "v4.5.0",
        "package": "github.com/golang-jwt/jwt/v4",
        "function": "ParseWithClaims",
        "position": {
          "filename": "token.go",
          "offset": 4856,
          "line": 113,
          "column": 6
        }
      },
      {
        "module": "sample/mod1",
        "package": "sample/mod1",
        "function": "Run",
        "position": {
          "filename": "mod1.go",
          "offset": 212,
          "line": 12,
          "column": 28
        }
      }
    ]
  }
}
```
